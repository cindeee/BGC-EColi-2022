library(plyr)
t_repsond =
count(posi,'Responder')
t_repsond
t_repsond = count(posi,'Responder', 'Diseaetype')
t_repsond = count(posi,'Responder', 'Disease.type')
install.packages('epiDisplay')
library(epiDisplay)
library(epiDisplay)
tab1(posi$Disease.type, posi$Responder)
CrossTable(posi$Disease.type, posi$Responder)
View(posi)
install.packages("gmodels")
library(gmodels)
CrossTable(posi$Disease.type, posi$Responder)
getSheetNames('v2.0_FW_SCFA.xlsx')
getSheetNames('v2.0_Faecal BAs_FINAL.xlsm')
scfa = read_excel('v2.0_FW_SCFA.xlsx', sheet = 'IC')
ba= read_excel('v2.0_Faecal BAs_FINAL.xlsm', sheet = 'Inception')
colnames(ba)
colnames(scfa)
colnames(scfa)
getSheetNames('v2.0_FW_SCFA.xlsx')
scfa = read_excel('v2.0_FW_SCFA.xlsx', sheet = 'IC_final')
colnames(scfa)
getSheetNames('v2.0_FW_SCFA.xlsx')
scfa = read_excel('v2.0_FW_SCFA.xlsx', sheet = 'IC_final')
getSheetNames('v2.0_Faecal BAs_FINAL.xlsm')
colnames(scfa)
scfa = read_excel('v2.0_FW_SCFA1.xlsx', sheet = 'IC_final')
colnames(scfa)
ba= read_excel('v2.0_Faecal BAs_FINAL.xlsm', sheet = 'Inception')
colnames(ba)
scfa = colClean(scfa)
ba = colClean(ba)
colnames(scfa)
colClean = function(x){ colnames(x) <- gsub("\\s|\\(|\\)|\\'|,|:|\\||\\/", ".", colnames(x)); x }
scfa = colClean(scfa)
colnames(scfa)
ba = colClean(ba)
colnames(ba)
nrows(scfa)
nrow(scfa)
nrow(ba)
check1 = scfa
check2 = ba
all(check1$Primary.ID == check2$Primary.ID)
intersect(intersect(names(rpos_t), names(rneg_t)), names(pos_t))
intersect(names(scfa), names(ba))
colnames(ba)
clean_fba = ba[-c(2,4:19) ]
clean_fba
joined_target = clean_fscfa %>%
left_join(clean_fba, by=c('Primary.ID'='Primary.ID', 'Disease.type'='Disease.type'))
joined_target = scfa %>%
left_join(clean_fba, by=c('Primary.ID'='Primary.ID', 'Disease.type'='Disease.type'))
View(joined_target)
intersect(names(scfa), names(ba))
joined_target
intersect(names(scfa), names(ba))
clean_fba = ba[-c(2,4:19) ]
joined_target = scfa %>%
left_join(clean_fba, by=c('Unique.Sample.ID'='Unique.Sample.ID', 'Disease.type'='Disease.type'))
View(scfa)
View(ba)
check2 = ba
colnames(ba)
clean_fba = ba[-c(4:19, 27, 28) ]
joined_target = scfa %>%
left_join(clean_fba, by=c('Unique.Sample.ID'='Unique.Sample.ID', 'Disease.type'='Disease.type'))
View(joined_target)
colnames(scfa)
scfa = read_excel('v2.0_FW_SCFA1.xlsx', sheet = 'IC_final')
View(scfa)
rm(list=ls(all= T))
# faecal dataset ----
getSheetNames('V2.0_serum_Reversephase_pos.xlsm')
setwd('C:/Users/cindy/OneDrive - Imperial College London/Desktop/IBD_project/data/serum')
getwd()
# faecal dataset ----
getSheetNames('V2.0_serum_Reversephase_pos.xlsm')
getSheetNames('V2.0serum_reverse-ve_.xlsm')
rneg = read_excel('V2.0serum_reverse-ve_.xlsm', sheet = 'Inception')
rpos = read_excel('V2.0_serum_Reversephase_pos.xlsm', sheet = 'Inception')
getSheetNames('V2.0_SerumLipid+_.xlsm')
getSheetNames('V2.0_SerumLipid+_.xlsm')
getSheetNames('v2.0_serum_Lipid-ve_Peakpantr.xlsm')
getSheetNames('V2.0_Hilic+serum peakpantr.xlsm')
rneg5 = read_excel('V2.0_Hilic+serum peakpantr.xlsm', sheet = 'Incpetion')
rneg5 = read_excel('V2.0_Hilic+serum peakpantr.xlsm', sheet = 'Inception')
lneg = read_excel('v2.0_serum_Lipid-ve_Peakpantr.xlsm', sheet = 'Inception')
hneg = read_excel('V2.0_Hilic+serum peakpantr.xlsm', sheet = 'Inception')
che()remove(rneg5)
remove(rneg5)
hneg = read_excel('V2.0_Hilic+serum peakpantr.xlsm', sheet = 'Inception')
lpos = read_excel('V2.0_SerumLipid+_.xlsm', sheet = 'Inception')
rpos = read_excel('V2.0_serum_Reversephase_pos.xlsm', sheet = 'Inception')
rneg = read_excel('V2.0serum_reverse-ve_.xlsm', sheet = 'Inception')
lpos = read_excel('V2.0_SerumLipid+_.xlsm', sheet = 'Inception')
lneg = read_excel('v2.0_serum_Lipid-ve_Peakpantr.xlsm', sheet = 'Inception')
hneg = read_excel('V2.0_Hilic+serum peakpantr.xlsm', sheet = 'Inception')
hpos = read_excel('V2.0_Hilic+serum peakpantr.xlsm', sheet = 'Inception')
colnames(hpos)
colClean = function(x){ colnames(x) <- gsub("\\s|\\(|\\)|\\'|,|:|\\||\\/", ".", colnames(x)); x }
rpos = colClean(rpos)
rneg = colClean(rneg)
lpos = colClean(lpos)
lneg = colClean(lneg)
hpos = colClean(hpos)
colnames(rpos)
colnames(rneg)
colnames(lpos)
colClean = function(x){ colnames(x) <- gsub("\\s|\\(|\\)|\\'|,|:|\\||\\/\\;", ".", colnames(x)); x }
rneg = colClean(rneg)
lpos = colClean(lpos)
lneg = colClean(lneg)
hpos = colClean(hpos)
rpos = colClean(rpos)
colnames(rpos)
colnames(lpos)
colClean = function(x){ colnames(x) <- gsub("\\s|\\(|\\)|\\'|,|:|\\||\\/|\\;", ".", colnames(x)); x }
rpos = colClean(rpos)
rneg = colClean(rneg)
lpos = colClean(lpos)
colnames(lpos)
rpos = colClean(rpos)
colnames(rpos)
colnames(rneg)
colnames(lpos)
colnames(lneg)
colnames(hpos)
colnames(rposi)
scfa = read_excel('v2.0_FW_SCFA1.xlsx', sheet = 'IC_final')
scfa = colClean(scfa)
scfa = read_excel('v2.0_FW_SCFA1.xlsx', sheet = 'IC_final')
scfa = read_excel('v2.0_FW_SCFA1.xlsx', sheet = 'IC_final')
setwd('C:/Users/cindy/OneDrive - Imperial College London/Desktop/IBD_project/data/faecal')
getwd()
scfa = read_excel('v2.0_FW_SCFA1.xlsx', sheet = 'IC_final')
scfa = read_excel('v2.0_FW_SCFA1.xlsx', sheet = 'IC_final')
View(scfa)
scfa = colClean(scfa)
colnames(scfa)
nrow(scfa)
# MISSING f027
scfa_ba = aov(Lactate.µmol.L, data = scfa)
scfa = colClean(scfa)
# MISSING f027
scfa_ba = aov(Lactate.µmol.L ~ Disease.type, data = scfa)
summary(scfa_ba)
TukeyHSD(scfa_ba)
colnames(scfa)
scfa_ba = aov(Acetate.µmol.L ~ Disease.type, data = scfa)
scfa_ba2 = aov(Acetate.µmol.L ~ Disease.type, data = scfa)
summary(scfa_ba2)
TukeyHSD(scfa_ba2)
scfa_ba3 = aov(Propionate.µmol.L ~ Disease.type, data = scfa)
summary(scfa_ba3)
TukeyHSD(scfa_ba3)
TukeyHSD(scfa_ba3)
scfa_ba4 = aov(2-Hydroxybutyrate.µmol.L ~ Disease.type, data = scfa)
summary(scfa_ba4)
TukeyHSD(scfa_ba4)
scfa_ba4 = aov(2-Hydroxybutyrate.µmol.L ~ Disease.type, data = scfa)
summary(scfa_ba4)
TukeyHSD(scfa_ba4)
scfa_ba4 = aov(2-Hydroxybutyrate.µmol.L ~ Disease.type, data = scfa)
# MISSING f027
colClean = function(x){ colnames(x) <- gsub("\\s|\\(|\\)|\\'|,|:|\\||\\/|\\-", ".", colnames(x)); x }
colnames(scfa)
View(scfa)
scfa = colClean(scfa)
colClean = function(x){ colnames(x) <- gsub("\\s|\\(|\\)|\\'|,|:|\\||\\/|\\-", ".", colnames(x)); x }
scfa = colClean(scfa)
colnames(scfa)
scfa_ba4 = aov( 2.Hydroxybutyrate.µmol.L ~ Disease.type, data = scfa)
scfa_ba4 = aov(scfa[25] ~ Disease.type, data = scfa)
scfa_ba4 = aov(scfa$`2.Hydroxybutyrate.µmol.L` ~ Disease.type, data = scfa)
scfa_ba4 = aov(scfa$`2.Hydroxybutyrate.µmol.L` ~ Disease.type, data = scfa)
summary(scfa_ba4)
TukeyHSD(scfa_ba4)
scfa_ba5 = aov(Isobutyrate.µmol.L ~ Disease.type, data = scfa)
summary(scfa_ba5)
TukeyHSD(scfa_ba5)
scfa_ba6 = aov(Butyrate.µmol.L ~ Disease.type, data = scfa)
summary(scfa_ba6)
TukeyHSD(scfa_ba6)
scfa_ba7 = aov('2.Methylbutyrate.µmol.L' ~ Disease.type, data = scfa)
scfa_ba7 = aov(`2.Methylbutyrate.µmol.L` ~ Disease.type, data = scfa)
summary(scfa_ba7)
TukeyHSD(scfa_ba7)
scfa_ba8 = aov(`Isovalerate.µmol.L` ~ Disease.type, data = scfa)
summary(scfa_ba8)
TukeyHSD(scfa_ba8)
View(scfa_ba3)
scfa_ba9 = aov(`Valerate.µmol.L` ~ Disease.type, data = scfa)
summary(scfa_ba9)
TukeyHSD(scfa_ba9)
scfa_ba10 = aov(`Hexanoate.µmol.L` ~ Disease.type, data = scfa)
summary(scfa_ba10)
TukeyHSD(scfa_ba10)
scfa_ba11 = aov(`Murocholic.Acid..10.1000nM.` ~ Disease.type, data = scfa)
summary(scfa_ba11)
TukeyHSD(scfa_ba11)
scfa_ba12 = aov(`5.beta.Cholanic.Acid.3.alpha..6.alpha.diol.7.one..2.5.1000.` ~ Disease.type, data = scfa)
summary(scfa_ba12)
TukeyHSD(scfa_ba12)
scfa_ba13 = aov(`Hyocholic.Acid..1.500NM.` ~ Disease.type, data = scfa)
summary(scfa_ba13)
TukeyHSD(scfa_ba13)
scfa_ba14 = aov(`Glycochenodeoxycholic.Acid..2.5.2500nM.` ~ Disease.type, data = scfa)
summary(scfa_ba14)
TukeyHSD(scfa_ba14)
scfa_ba15 = aov(`Glycocholic.Acid..2.5.2500.` ~ Disease.type, data = scfa)
summary(scfa_ba15)
TukeyHSD(scfa_ba15)
scfa_ba16 = aov(`Taurocholic.Acid..2.5.2500.` ~ Disease.type, data = scfa)
summary(scfa_ba16)
TukeyHSD(scfa_ba16)
scfa_ba17 = aov(`Glycolithocholic.Acid.3.Sulfate..2.5.2500.` ~ Disease.type, data = scfa)
summary(scfa_ba17)
TukeyHSD(scfa_ba17)
scfa_ba16 = aov(`Taurocholic.Acid..2.5.2500.` ~ Disease.type, data = scfa)
summary(scfa_ba16)
TukeyHSD(scfa_ba16)
scfa_ba15 = aov(`Glycocholic.Acid..2.5.2500.` ~ Disease.type, data = scfa)
summary(scfa_ba15)
TukeyHSD(scfa_ba15)
scfa_ba14 = aov(`Glycochenodeoxycholic.Acid..2.5.2500nM.` ~ Disease.type, data = scfa)
summary(scfa_ba14)
TukeyHSD(scfa_ba14)
scfa_ba13 = aov(`Hyocholic.Acid..1.500NM.` ~ Disease.type, data = scfa)
summary(scfa_ba13)
TukeyHSD(scfa_ba13)
getSheetNames('V2.0_Urine ReversePOS_selected.xlsm')
setwd('C:/Users/cindy/OneDrive - Imperial College London/Desktop/IBD_project/data/urine')
getwd()
getSheetNames('V2.0_Urine ReversePOS_selected.xlsm')
getSheetNames('V2.0_UrineReverseNEG_xlsm.xlsm')
getSheetNames('V2.0Urine_HilicPOS_.xlsm')
urposi = read_excel('V2.0_Urine ReversePOS_selected', sheet = 'Inception cohort')
urnegi = read_excel('V2.0_UrineReverseNEG_xlsm', sheet = 'Inception cohort')
uposi = read_excel('V2.0Urine_HilicPOS_', sheet = 'Inception cohort')
urposi = read_excel('V2.0_Urine ReversePOS_selected.xlsm', sheet = 'Inception cohort')
urnegi = read_excel('V2.0_UrineReverseNEG_xlsm.xlsm', sheet = 'Inception cohort')
uposi = read_excel('V2.0Urine_HilicPOS_.xlsm', sheet = 'Inception cohort')
sapply(joined, class)
joined[,8:11] = lapply(joined[,8:11], factor)
getSheetNames('v2.0_FW Reversepositive_.xlsm')
getSheetNames('v2.0_FW_ReverseNEG_AnnotatedData.xlsm')
getSheetNames('V2.0FINAL_STR_HPOS_Annotated_combinedData.xlsm')
rposi = read_excel('v2.0_FW Reversepositive_.xlsm', sheet = 'Inception cohort')
rnegi = read_excel('v2.0_FW_ReverseNEG_AnnotatedData.xlsm', sheet = 'Inception')
posi = read_excel('V2.0FINAL_STR_HPOS_Annotated_combinedData.xlsm', sheet = 'Inception cohort')
rpos_master = read_excel('v2.0_FW Reversepositive_.xlsm', sheet = 2)
## inception :: pca ----
# venn diagram
colnames(rpos_master)
rpos_master = colClean(rpos_master)
nrow(rpos_master$UniqueSampleID)
## 1. untargeted metabolite ----
#column names and cleaning
colnames(rposi)
colnames(rnegi)
colClean = function(x){ colnames(x) <- gsub("\\s|\\(|\\)|\\'|,|:|\\||\\/", ".", colnames(x)); x }
rposi = colClean(rposi)
rnegi = colClean(rnegi)
posi = colClean(posi)
colnames(rposi)
colnames(rnegi)
colnames(posi)
# remove columns and join
posi = posi %>%
rename(Sample.check = Check.sample.ID)
intersect(intersect(names(rposi), names(rnegi)), names(posi))
clean_mi1 = rposi[ -c(1,2,7:10,18) ]
clean_mi2 = rnegi[-c(1,2,4:18)]
clean_mi3 = posi[ -c(1,2,4:18) ]
joined = clean_mi1 %>%
left_join(clean_mi2, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type')) %>%
left_join(clean_mi3, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type'))
dim(joined)
joinedn = joined[,13:134]
joined_z = (joinedn-rowMeans(joinedn))/(rowSds(as.matrix(joinedn)))[row(joinedn)]
joined[,13:134] = joined_z
joined = joined %>%
arrange(desc(Disease.type), Sample.check)
getSheetNames('v2.0_FW Reversepositive_.xlsm')
getSheetNames('v2.0_FW_ReverseNEG_AnnotatedData.xlsm')
getSheetNames('V2.0FINAL_STR_HPOS_Annotated_combinedData.xlsm')
rposi = read_excel('v2.0_FW Reversepositive_.xlsm', sheet = 'Inception cohort')
rnegi = read_excel('v2.0_FW_ReverseNEG_AnnotatedData.xlsm', sheet = 'Inception')
posi = read_excel('V2.0FINAL_STR_HPOS_Annotated_combinedData.xlsm', sheet = 'Inception cohort')
rpos_master = read_excel('v2.0_FW Reversepositive_.xlsm', sheet = 2)
## inception :: pca ----
# venn diagram
colnames(rpos_master)
rpos_master = colClean(rpos_master)
nrow(rpos_master$UniqueSampleID)
## 1. untargeted metabolite ----
#column names and cleaning
colnames(rposi)
colnames(rnegi)
colClean = function(x){ colnames(x) <- gsub("\\s|\\(|\\)|\\'|,|:|\\||\\/", ".", colnames(x)); x }
rposi = colClean(rposi)
rnegi = colClean(rnegi)
posi = colClean(posi)
colnames(rposi)
colnames(rnegi)
colnames(posi)
# remove columns and join
posi = posi %>%
rename(Sample.check = Check.sample.ID)
intersect(intersect(names(rposi), names(rnegi)), names(posi))
clean_mi1 = rposi[ -c(1,2,7:10,18) ]
clean_mi2 = rnegi[-c(1,2,4:18)]
clean_mi3 = posi[ -c(1,2,4:18) ]
joined = clean_mi1 %>%
left_join(clean_mi2, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type')) %>%
left_join(clean_mi3, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type'))
dim(joined)
joinedn = joined[,13:134]
joined_z = (joinedn-rowMeans(joinedn))/(rowSds(as.matrix(joinedn)))[row(joinedn)]
joined[,13:134] = joined_z
joined = joined %>%
arrange(desc(Disease.type), Sample.check)
setwd('C:/Users/cindy/OneDrive - Imperial College London/Desktop/IBD_project/data/faecal')
getwd()
# faecal dataset ----
getSheetNames('v2.0_FW Reversepositive_.xlsm')
getSheetNames('v2.0_FW_ReverseNEG_AnnotatedData.xlsm')
getSheetNames('V2.0FINAL_STR_HPOS_Annotated_combinedData.xlsm')
rposi = read_excel('v2.0_FW Reversepositive_.xlsm', sheet = 'Inception cohort')
rnegi = read_excel('v2.0_FW_ReverseNEG_AnnotatedData.xlsm', sheet = 'Inception')
posi = read_excel('V2.0FINAL_STR_HPOS_Annotated_combinedData.xlsm', sheet = 'Inception cohort')
rpos_master = read_excel('v2.0_FW Reversepositive_.xlsm', sheet = 2)
## inception :: pca ----
# venn diagram
colnames(rpos_master)
rpos_master = colClean(rpos_master)
nrow(rpos_master$UniqueSampleID)
## 1. untargeted metabolite ----
#column names and cleaning
colnames(rposi)
colnames(rnegi)
colClean = function(x){ colnames(x) <- gsub("\\s|\\(|\\)|\\'|,|:|\\||\\/", ".", colnames(x)); x }
rposi = colClean(rposi)
rnegi = colClean(rnegi)
posi = colClean(posi)
colnames(rposi)
colnames(rnegi)
colnames(posi)
posi = posi %>%
rename(Sample.check = Check.sample.ID)
intersect(intersect(names(rposi), names(rnegi)), names(posi))
clean_mi1 = rposi[ -c(1,2,7:10,18) ]
clean_mi2 = rnegi[-c(1,2,4:18)]
clean_mi3 = posi[ -c(1,2,4:18) ]
joined = clean_mi1 %>%
left_join(clean_mi2, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type')) %>%
left_join(clean_mi3, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type'))
dim(joined)
joinedn = joined[,13:134]
joined_z = (joinedn-rowMeans(joinedn))/(rowSds(as.matrix(joinedn)))[row(joinedn)]
joined[,13:134] = joined_z
joined = joined %>%
arrange(desc(Disease.type), Sample.check)
posi
View(posi)
colnames(posi)
colnames(rnegi)
posi = posi %>%
rename(Sample.check = Check.sample.ID)
intersect(intersect(names(rposi), names(rnegi)), names(posi))
clean_mi1 = rposi[ -c(1,2,7:10,18) ]
clean_mi2 = rnegi[-c(1,2,4:18)]
clean_mi3 = posi[ -c(1,2,4:18) ]
joined = clean_mi1 %>%
left_join(clean_mi2, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type')) %>%
left_join(clean_mi3, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type'))
=
rnegi = read_excel('v2.0_FW_ReverseNEG_AnnotatedData.xlsm', sheet = 'Inception')
posi = colClean(posi)
colnames(rposi)
colnames(rnegi)
colnames(posi)
# remove columns and join
posi = posi %>%
rename(Sample.check = Check.sample.ID)
intersect(intersect(names(rposi), names(rnegi)), names(posi))
clean_mi1 = rposi[ -c(1,2,7:10,18) ]
clean_mi2 = rnegi[-c(1,2,4:18)]
clean_mi3 = posi[ -c(1,2,4:18) ]
joined = clean_mi1 %>%
left_join(clean_mi2, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type')) %>%
left_join(clean_mi3, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type'))
colnames(rposi)
intersect(intersect(names(rposi), names(rnegi)), names(posi))
View(rnegi)
View(rnegi)
posi = posi %>%
rename(Sample.check= Check.sample.ID)
colnames(posi)
setwd('C:/Users/cindy/OneDrive - Imperial College London/Desktop/IBD_project/data/faecal')
getwd()
# faecal dataset ----
getSheetNames('v2.0_FW Reversepositive_.xlsm')
getSheetNames('v2.0_FW_ReverseNEG_AnnotatedData.xlsm')
getSheetNames('V2.0FINAL_STR_HPOS_Annotated_combinedData.xlsm')
rposi = read_excel('v2.0_FW Reversepositive_.xlsm', sheet = 'Inception cohort')
rnegi = read_excel('v2.0_FW_ReverseNEG_AnnotatedData.xlsm', sheet = 'Inception')
posi = read_excel('V2.0FINAL_STR_HPOS_Annotated_combinedData.xlsm', sheet = 'Inception cohort')
rpos_master = read_excel('v2.0_FW Reversepositive_.xlsm', sheet = 2)
## inception :: pca ----
#column names and cleaning
colnames(rposi)
colnames(rnegi)
colClean = function(x){ colnames(x) <- gsub("\\s|\\(|\\)|\\'|,|:|\\||\\/", ".", colnames(x)); x }
rposi = colClean(rposi)
rnegi = colClean(rnegi)
posi = colClean(posi)
colnames(rposi)
colnames(rnegi)
colnames(posi)
# remove columns and join
posi = posi %>%
rename(`Sample.check`= `Check.sample.ID`)
intersect(intersect(names(rposi), names(rnegi)), names(posi))
clean_mi1 = rposi[ -c(1,2,7:10,18) ]
clean_mi2 = rnegi[-c(1,2,4:18)]
clean_mi3 = posi[ -c(1,2,4:18) ]
joined = clean_mi1 %>%
left_join(clean_mi2, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type')) %>%
left_join(clean_mi3, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type'))
colnames(rposi)
colnames(rnegi)
intersect(intersect(names(rposi), names(rnegi)), names(posi))
clean_mi1 = rposi[ -c(1,2,7:10,18) ]
clean_mi2 = rnegi[-c(1,2,4:18)]
clean_mi3 = posi[ -c(1,2,4:18) ]
joined = clean_mi1 %>%
left_join(clean_mi2, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type')) %>%
left_join(clean_mi3, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type'))
intersect(intersect(names(rposi), names(rnegi)), names(posi))
colnames(rnegi)
colnames(posi)
# remove columns and join
posi = posi %>%
rename(`Sample.check`= `Check.sample.ID`)
colnames(posi)
library(readxl)
library(matrixStats)
library(openxlsx)
library(dplyr)
library(tidyverse)
# remove columns and join
posi = posi %>%
rename(`Sample.check`= `Check.sample.ID`)
library(readxl)
library(matrixStats)
library(openxlsx)
library(dplyr)
library(tidyverse)
#install.packages('gmodels')
library(gmodels)
rm(list=ls(all= T))
setwd('C:/Users/cindy/OneDrive - Imperial College London/Desktop/IBD_project/data/faecal')
getwd()
# faecal dataset ----
getSheetNames('v2.0_FW Reversepositive_.xlsm')
getSheetNames('v2.0_FW_ReverseNEG_AnnotatedData.xlsm')
getSheetNames('V2.0FINAL_STR_HPOS_Annotated_combinedData.xlsm')
rposi = read_excel('v2.0_FW Reversepositive_.xlsm', sheet = 'Inception cohort')
rnegi = read_excel('v2.0_FW_ReverseNEG_AnnotatedData.xlsm', sheet = 'Inception')
posi = read_excel('V2.0FINAL_STR_HPOS_Annotated_combinedData.xlsm', sheet = 'Inception cohort')
rpos_master = read_excel('v2.0_FW Reversepositive_.xlsm', sheet = 2)
## inception :: pca ----
# venn diagram
colnames(rpos_master)
rpos_master = colClean(rpos_master)
nrow(rpos_master$UniqueSampleID)
## 1. untargeted metabolite ----
#column names and cleaning
colnames(rposi)
colnames(rnegi)
colClean = function(x){ colnames(x) <- gsub("\\s|\\(|\\)|\\'|,|:|\\||\\/", ".", colnames(x)); x }
rposi = colClean(rposi)
rnegi = colClean(rnegi)
posi = colClean(posi)
colnames(rposi)
colnames(rnegi)
colnames(posi)
# remove columns and join
posi = posi %>%
rename(`Sample.check`= `Check.sample.ID`)
intersect(intersect(names(rposi), names(rnegi)), names(posi))
clean_mi1 = rposi[ -c(1,2,7:10,18) ]
clean_mi2 = rnegi[-c(1,2,4:18)]
clean_mi3 = posi[ -c(1,2,4:18) ]
joined = clean_mi1 %>%
left_join(clean_mi2, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type')) %>%
left_join(clean_mi3, by=c('Sample.check'='Sample.check', 'Disease.type'='Disease.type'))
colnames(clean_mi1)
colnames(clean_mi2)
colnames(clean_mi3)
View(posi)
# remove columns and join
posi = posi %>%
rename(Sample.check= Check.sample.ID)
# remove columns and join
posi = posi %>%
rename(Sample.check== Check.sample.ID)
